# build/bless --main-lcore 0 -c 0x7 -n 4 \
# -- -p 0x3 -a1 -i1 -u1 -t1 -b512 -s-1 \
# --src-ip=192.168.0.1+-99 --dst-ip=172.16.0.1+10 \
# --dst-mac=10:70:fd:af:21:10 \
# --src-port=8000+100 --dst-port=9000+-100 \
# --vxlan=1.1.1.1,2.2.2.2,1234+6,50 \
# --erroneous=...

dpdk:
  main-lcore: 0
  l: 0,1-6
  n: 4
  lcores: null
  socket-mem: null
  allow: null # [ 00:04.0, 00:05.0 ]
  block: [ 00:04.0 ]
  vdev: null # net_tap0,iface=tap0
  proc-type: primary
  log-level: info
  trace: regex-match
  trace-dir: /tmp
  trace-bufsz: 100M
  trace-mode: discard
  huge-dir: /dev/hugepages
  file-prefix: null # bless

injector:
  p: 0x3f
  q: 1
  T: 1
  P:
  no-mac-updating:
  portmap: null # (0, 1)
  batch: 512
  num: -1
  arp: 1
  icmp: 1
  tcp: 1
  udp: 1

bless:
  ether:
    mtu: 1500 # size of ether payload, may result in error if vxlan enabled
    dst: 10:70:fd:af:21:10
    src: 10:70:fd:af:21:02
    type:
      arp:
        src: [ 10.0.0.1 ]
        dst: [ 20.0.0.2, 30.0.0.3, 40.0.0.4 ]
      ip:
        src: 172.16.1.1+-99
        dst: [ 192.168.0.1, 192.168.1.1, 192.168.2.1 ]
        icmp:
          ident: [ 0x1234, 0xface ]
          payload: "injector: icmp payload." # not used, yet
        tcp:
          src: [ 80, 808, 8080, 8888 ]
          dst: 9000+1000
          payload: "injector: tcp payload."
        udp:
          src: 8000+-2000
          dst: [ 10000, 10001, 10003 ]
          payload: "injector: udp payload."
  vxlan:
    enable: true
    ratio: 80
    ether:
      dst: 10:70:fd:af:21:10
      src: 10:70:fd:af:21:02
      type:
        ip:
          src: [ 1.0.0.1:1891, 2.0.0.2:2892, 3.0.0.3:3893 ]
          src-range: 0 # not supported
          dst: [ 4.0.0.4, 5.0.0.5, 6.0.0.6 ]
          dst-range: -5 # not supported
          udp:
            src: [ 4000, 4001, 4002 ]
            src-range: 123 # no use
            dst: 4789
            dst-range: 10
  erroneous:
    ratio: 0
    class:
      mac: [ vlan, multicast, ipv6 ] # 0, 1, 2
      arp: [ src ] # 3
      ip: [ version, ihl, dscp, ecn, total_length, id, flags, fragment_offset, ttl, protocol, cksum, ipsec ] #
      #     4        5    6     7    8             9   10     11               12   13        14     15
      icmp: [ type ] # 16
      tcp: [ syn_flood, data_off, flags, window, cksum ]
      #      17         18        19     20      21
      udp: [ len, cksum, vxlan ] # 22, 23, 24
